branches:
  except:
  - "/^untagged/"
language: node_js
os:
- linux
node_js:
- 16
script: npm run package
deploy:
- provider: releases
  token:
    secure: FJ9W8s2sT+71IOkyWBbkmXjq0qc0l9S+/G227dKqEq4sdaNhU3kAhH5LBZdB87KQ+kpnVtDAbQN3+eMunycSah1/o1Ld0FSAIJGZGRm1d2rpYxbmiw3kvQFjzEUE/4yMVLtfTwYNNOXTN037KEIsJTvBBCZ2yKfizGfQkIQU4GsXi6m705uSl1LmlhslsxtWrlmTZLGo5TFkkEYFUwcSpNxtKOV7nXAvGFeFm08sRi7Bsl2Cw5DUrgzKD/WPdhTEZBUaWQ+LWQ2rgW25cNxhafOjqt1/sJcuqbs3W4OzOYU2wuWG/NAEeGwk1Pr5FGZHnREYExaSYqLY7wKiDbdZT10ni4IBkuG2nMmsAi7kgLE+u2gxQhy3CMgvUbYUZuOFCygnmnO5MkjXOEDUIQqF+FTkF4tvJGsBudDvMjGWsyW4LLZMk6KW98P/0Bt81T1OMRKsYsfaCfWcfSFbJwiY54r0CdyNv18/0qNi8Zf7I/DGF9SSyg5sG89xQQ53SyCgwWVVpP8UMBNFXQqpuFI+WY0zINrwTbf1OOEPACgOpwESaEFO/JjTxFoGfHY6r199e2tzYeQQzw3EpLFvhMZODbB7o5p5rSzt0VdbP38YgDYspg4bjJNWXntSNjKeuGMhzsEWS1xWxxa0cdZJPeBa8CAPAGNfWeE4NWwULz4oN8Y=
  skip_cleanup: true
  file_glob: true
  file: "*.vsix"
  on:
    repo: lefebsy/vskubi-lite
    tags: true
- provider: script
  script: vsce publish --pat $MARKET_PERSONAL_ACCESS_TOKEN
  skip_cleanup: true
  file_glob: true
  file: "*.vsix"
  on:
    repo: lefebsy/vskubi-lite
    tags: true
- provider: script
  script: npm install --global ovsx && npx ovsx publish ./*.vsix --pat $OPEN_MARKET_PERSONAL_ACCESS_TOKEN
  skip_cleanup: true
  file_glob: true
  file: "*.vsix"
  on:
    repo: lefebsy/vskubi-lite
    tags: true
